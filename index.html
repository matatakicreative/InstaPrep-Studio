
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>InstaPrep Studio - AI Post Tool</title>
  
  <!-- UI Frameworks & Fonts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Noto+Sans+JP:wght@400;700&family=Inter:wght@400;700&family=Londrina+Shadow&family=Bebas+Neue&family=Outfit:wght@800&display=swap" rel="stylesheet">
  
  <!-- React & Babel for Browser Rendering -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.2.4",
    "react-dom": "https://esm.sh/react-dom@19.2.4",
    "react-dom/client": "https://esm.sh/react-dom@19.2.4/client",
    "lucide-react": "https://esm.sh/lucide-react@0.474.0?external=react",
    "@google/genai": "https://esm.sh/@google/genai@1.41.0",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>

  <style>
    body {
      margin: 0;
      background-color: #F8F9FA;
      background-image: radial-gradient(at 0% 0%, #C1E1DC 0px, transparent 50%), radial-gradient(at 100% 0%, #FFCCAC 0px, transparent 50%);
      background-attachment: fixed;
      min-height: 100vh;
      font-family: 'Inter', 'Noto Sans JP', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    .card-ios {
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 28px;
      border: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.05);
    }
    .font-londrina { font-family: 'Londrina Shadow', cursive; }
    .font-caveat { font-family: 'Caveat', cursive; }
    .font-bebas { font-family: 'Bebas Neue', sans-serif; }
    
    @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .animate-in { animation: fadeIn 0.5s ease-out forwards; }
    
    #root:empty::after {
      content: "LOADING STUDIO...";
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      font-family: 'Bebas Neue', sans-serif; font-size: 24px; color: #FDD475;
      letter-spacing: 5px; animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel" data-type="module">
    import React, { useState, useEffect } from 'react';
    import ReactDOM from 'react-dom/client';
    import { 
      Languages, Clock, Phone, Hash, Sparkles, Copy, Check, Instagram, 
      ArrowRight, Plus, Trash2, Smartphone
    } from 'lucide-react';
    import { GoogleGenAI, Type } from "@google/genai";

    // --- CONSTANTS ---
    const COLORS = {
      BABY_BLUE: '#C1E1DC',
      PEACH: '#FFCCAC',
      BUTTER: '#FFEB94',
      BUTTERSCOTCH: '#FDD475'
    };
    const DEFAULT_TAGS = ['Vernon', 'BC', 'Okanagan', 'ExploreBC', 'ShopLocal'];
    const SHOP_PHONE = "778-475-6191";

    // --- COMPONENTS ---
    const CopyButton = ({ text, label, baseColor, className = "" }) => {
      const [copied, setCopied] = useState(false);
      const handleCopy = () => {
        if (!text) return;
        navigator.clipboard.writeText(text);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      };
      return (
        <button 
          onClick={handleCopy}
          style={{ backgroundColor: copied ? '#10b981' : baseColor }}
          className={`flex items-center justify-center gap-2 px-5 py-2.5 rounded-2xl text-[10px] font-black text-slate-800 transition-all active:scale-95 shadow-sm border-b-4 border-black/10 active:border-b-0 active:translate-y-1 ${className}`}
        >
          {copied ? <Check size={14}/> : <Copy size={14}/>}
          {copied ? "COPIED!" : (label || "COPY")}
        </button>
      );
    };

    const SectionHeader = ({ icon: Icon, title, color }) => (
      <div className="flex items-center gap-3 mb-5">
        <div className="w-12 h-12 rounded-[20px] flex items-center justify-center shadow-inner" style={{ backgroundColor: color + '90' }}>
          <Icon size={24} className="text-slate-700" />
        </div>
        <h2 className="text-sm font-black text-slate-800 tracking-widest uppercase">{title}</h2>
      </div>
    );

    // --- MAIN APP ---
    const App = () => {
      const [prompt, setPrompt] = useState("");
      const [loading, setLoading] = useState(false);
      const [result, setResult] = useState(null);
      const [hours, setHours] = useState({ open: "12:00 PM", close: "6:30 PM" });
      const [tags, setTags] = useState(() => {
        const saved = localStorage.getItem('insta-tags-v5');
        return saved ? JSON.parse(saved) : DEFAULT_TAGS.map(t => ({ id: Math.random().toString(), text: t, active: false }));
      });

      useEffect(() => { localStorage.setItem('insta-tags-v5', JSON.stringify(tags)); }, [tags]);

      const handleGenerate = async () => {
        if (!prompt.trim()) return;
        setLoading(true);
        try {
          const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
          const response = await ai.models.generateContent({
            model: 'gemini-3-flash-preview',
            contents: prompt,
            config: {
              systemInstruction: `Instagram„ÅÆÊäïÁ®ø„ÇíÊîØÊè¥„Åô„Çã„Ç®„Ç≠„Çπ„Éë„Éº„Éà„Å®„Åó„Å¶ÊåØ„ÇãËàû„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊó•Êú¨Ë™û„ÅÆÂÖ•Âäõ„Åã„ÇâËã±Ë™û„ÅÆÊäïÁ®øÊ°à„Çí‰ΩúÊàê„Åó„ÄÅ‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
              {
                "caption": "È≠ÖÂäõÁöÑ„Å™Ëã±Ë™û„ÅÆÊäïÁ®øÊú¨Êñá",
                "caption_jp": "Êú¨Êñá„ÅÆÊó•Êú¨Ë™ûË®≥",
                "imagePhrase": "ÁîªÂÉè„Å´ÂÖ•„Çå„Çã3-5Ë™û„ÅÆ„Ç≠„É£„ÉÉ„ÉÅ„Éº„Å™Ëã±Ë™û",
                "imagePhrase_jp": "„Åù„ÅÆÊó•Êú¨Ë™ûË®≥"
              }`,
              responseMimeType: "application/json",
              responseSchema: {
                type: Type.OBJECT,
                properties: {
                  caption: { type: Type.STRING },
                  caption_jp: { type: Type.STRING },
                  imagePhrase: { type: Type.STRING },
                  imagePhrase_jp: { type: Type.STRING }
                },
                required: ["caption", "caption_jp", "imagePhrase", "imagePhrase_jp"]
              }
            }
          });
          setResult(JSON.parse(response.text));
        } catch (e) {
          console.error(e);
          alert("AIÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ");
        } finally {
          setLoading(false);
        }
      };

      const toggleTag = (id) => setTags(tags.map(t => t.id === id ? { ...t, active: !t.active } : t));
      const activeTagsStr = tags.filter(t => t.active).map(t => `#${t.text}`).join(' ');
      const hoursStr = `We're open from ${hours.open} to ${hours.close} today.`;
      const finalContent = result ? `„Äê${result.imagePhrase}„Äë\n${result.caption}\n\nüìû ${SHOP_PHONE}\n‚è∞ ${hoursStr}\n\n${activeTagsStr}` : "";

      return (
        <div className="max-w-xl mx-auto px-6 py-12 md:py-20">
          <header className="text-center mb-12">
            <h1 className="text-6xl font-londrina text-slate-900 mb-2">InstaPrep</h1>
            <p className="font-caveat text-2xl text-orange-400">Smart Creator Studio</p>
          </header>

          <div className="flex flex-col gap-10">
            {/* Input Section */}
            <section className="card-ios p-8 shadow-2xl">
              <SectionHeader icon={Languages} title="Draft Input" color={COLORS.BABY_BLUE} />
              <textarea 
                value={prompt}
                onChange={e => setPrompt(e.target.value)}
                placeholder="‰ªäÊó•‰ºù„Åà„Åü„ÅÑ„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÊó•Êú¨Ë™û„ÅßÂÖ•Âäõ..."
                className="w-full h-36 p-5 rounded-[24px] bg-white/40 border border-slate-100 outline-none focus:ring-4 focus:ring-blue-100/50 transition-all text-slate-700 font-medium text-base resize-none"
              />
              <button 
                onClick={handleGenerate}
                disabled={loading || !prompt}
                className="w-full mt-6 py-5 rounded-[24px] bg-[#FDD475] text-slate-800 font-black text-xl shadow-lg shadow-yellow-200/50 active:scale-95 disabled:opacity-50 transition-all flex items-center justify-center gap-3"
              >
                {loading ? "GENERATING..." : <><Sparkles size={24} className="text-orange-500" /> ÊñáÁ´†„ÇíÁîüÊàê„Åô„Çã</>}
              </button>
            </section>

            {/* AI Results */}
            {result && (
              <div className="space-y-6 animate-in">
                <div className="card-ios p-8 border-orange-100">
                   <span className="text-[10px] font-black text-orange-400 uppercase tracking-widest block mb-3">Main Message</span>
                   <p className="text-3xl font-black text-slate-800 leading-tight mb-6 italic">"{result.imagePhrase}"</p>
                   <div className="flex justify-between items-center">
                      <span className="text-xs text-slate-400 italic font-medium">Ë®≥: {result.imagePhrase_jp}</span>
                      <CopyButton text={result.imagePhrase} baseColor={COLORS.PEACH} />
                   </div>
                </div>
                <div className="card-ios p-8 border-blue-100">
                   <span className="text-[10px] font-black text-blue-400 uppercase tracking-widest block mb-3">Post Caption</span>
                   <p className="text-base leading-relaxed text-slate-700 font-medium mb-6 whitespace-pre-wrap">{result.caption}</p>
                   <div className="flex justify-between items-center pt-6 border-t border-slate-50">
                      <span className="text-[10px] text-slate-400 max-w-[60%] line-clamp-1">{result.caption_jp}</span>
                      <CopyButton text={result.caption} baseColor={COLORS.BABY_BLUE} />
                   </div>
                </div>
              </div>
            )}

            {/* Utility Grid */}
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-5">
              <div className="card-ios p-6">
                <SectionHeader icon={Clock} title="Business Hours" color={COLORS.BUTTER} />
                <div className="flex gap-2 mb-4">
                   <input type="text" value={hours.open} onChange={e => setHours({...hours, open: e.target.value})} className="w-1/2 bg-white/50 p-3 rounded-xl text-xs font-bold border border-slate-50" />
                   <input type="text" value={hours.close} onChange={e => setHours({...hours, close: e.target.value})} className="w-1/2 bg-white/50 p-3 rounded-xl text-xs font-bold border border-slate-50" />
                </div>
                <CopyButton text={hoursStr} baseColor={COLORS.BUTTER} label="COPY HOURS" className="w-full" />
              </div>
              <div className="card-ios p-6">
                <SectionHeader icon={Smartphone} title="Quick Phone" color={COLORS.PEACH} />
                <div className="text-lg font-black text-slate-800 mb-4 p-3 bg-white/50 rounded-xl text-center border border-slate-50">{SHOP_PHONE}</div>
                <CopyButton text={SHOP_PHONE} baseColor={COLORS.PEACH} className="w-full" />
              </div>
            </div>

            {/* Hashtags */}
            <section className="card-ios p-8">
              <SectionHeader icon={Hash} title="Hashtags" color={COLORS.BABY_BLUE} />
              <div className="flex flex-wrap gap-2.5 mb-8">
                {tags.map(t => (
                  <button 
                    key={t.id} onClick={() => toggleTag(t.id)}
                    className={`px-4 py-2 rounded-2xl text-[11px] font-black transition-all ${t.active ? 'bg-slate-800 text-white shadow-xl scale-110' : 'bg-white text-slate-400 border border-slate-100 hover:border-slate-300'}`}
                  >
                    #{t.text}
                  </button>
                ))}
                <button className="px-4 py-2 rounded-2xl border-2 border-dashed border-slate-200 text-slate-300 hover:border-slate-400 transition-colors">
                  <Plus size={14} />
                </button>
              </div>
              <CopyButton text={activeTagsStr} baseColor={COLORS.BABY_BLUE} label="COPY ACTIVE TAGS" className="w-full" />
            </section>

            {/* Final Preview Container */}
            <section className="card-ios p-8 bg-slate-900 text-white border-none shadow-2xl relative overflow-hidden min-h-[400px] flex flex-col">
              <div className="absolute top-0 right-0 p-6 opacity-10 pointer-events-none">
                <Instagram size={150} />
              </div>
              <h2 className="text-xl font-black flex items-center gap-3 mb-6 relative z-10">
                <Instagram size={24} className="text-pink-500" /> INSTAGRAM PREVIEW
              </h2>
              <div className="flex-grow bg-slate-800/60 backdrop-blur-md rounded-[24px] p-6 text-[12px] font-mono leading-relaxed text-slate-300 mb-8 border border-white/5 relative z-10 whitespace-pre-wrap">
                {finalContent || "ÊñáÁ´†„ÇíÁîüÊàê„Åô„Çã„Å®„Åì„Åì„Å´ÂÆåÊàê„Ç§„É°„Éº„Ç∏„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô..."}
              </div>
              {result && (
                <button 
                  onClick={() => {
                    navigator.clipboard.writeText(finalContent);
                    alert("„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅInstagram„Å∏GOÔºÅ");
                  }}
                  className="w-full py-6 rounded-[24px] bg-gradient-to-r from-orange-300 via-yellow-300 to-orange-300 text-slate-900 font-black text-base uppercase tracking-widest shadow-2xl active:scale-95 transition-transform relative z-10"
                >
                  Copy Everything to Clipboard
                </button>
              )}
            </section>
          </div>

          <footer className="mt-24 text-center">
            <p className="opacity-20 text-[10px] font-black uppercase tracking-[0.4em]">
              ¬© 2025 InstaPrep Studio ‚Ä¢ Crafting Digital Stories
            </p>
          </footer>
        </div>
      );
    };

    // --- RENDER ---
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
